---
title: ã€Vueã€‘æºç è§£æ
date: 2019-03-18 09:50:34
categories: Vue
tags: Vue
---

ç°åœ¨ä¸‰å¤§æ¡†æ¶é£èµ·äº‘æ¶Œï¼Œ JQueryè€å¤§å“¥çš„å…‰è¾‰ä¸å†ï¼Œ ä½¿å‰ç«¯æˆä¸ºäº†å„è·¯è¯¸ä¾¯çš„å…µå®¶å¿…äº‰ä¹‹åœ°ï¼Œ 

å½“ç„¶ä½œä¸ºä¸€åä¼˜è´¨çš„å‰ç«¯ï¼Œå…‰è·Ÿé£å­¦æ¡†æ¶æ˜¯è‚¯å®šä¸è¡Œçš„ï¼Œ è¦çŸ¥å…¶ç„¶è€ŒçŸ¥å…¶æ‰€ä»¥ç„¶

è¦äº†è§£MVVMçš„æœ¬è´¨åŸç†ï¼Œ `virtual Dom`å’Œ `Diff`ç®—æ³•å¸¦æ¥çš„å¥½å¤„ä»¥åŠåå¤„

æ‹’ç»ç›²ç›®è·Ÿé£


## ğŸdiffDomä¼˜åŠ£
ç°åœ¨å¾ˆå¤šäººéƒ½è¯´ `Vue`, `React` å¤šç‰›ï¼Œ `Diff`ç®—æ³•å¿«ï¼Œä¸ç”¨æ“ä½œ`Dom`ã€‚

åªèƒ½æ— è¯­ã€‚

`Diff`ç®—æ³•ä¸æ˜¯ä¸éœ€è¦æ“ä½œ`Dom`,  è€Œæ˜¯ä¸éœ€è¦å¼€å‘è€…å»æ“ä½œ`Dom`äº†ï¼Œ `Diff`ç®—æ³•å…¶å®ä¸å¿«ï¼Œ å°±ç®—ä½¿ç”¨äº†`virtual Dom`,  è¿˜å¾—èŠ±å®ç°æŠŠçœŸå®`Dom` è½¬æ¢ä¸º `virtual Dom` å†å»æ¯”å¯¹ï¼Œ è¿™è¿œè¿œæ²¡æœ‰`js`ç›´æ¥ `getElementById`ç›´è¾¾ç›®æ ‡æ¥çš„å¿«

é‚£Diffç®—æ³•ä¸å¿«ä¸ºä»€ä¹ˆè¿˜è¦ç”¨å‘¢?

`Diff`ç®—æ³•å…¶å®æ˜¯ç»™é‚£äº›æ¯”è¾ƒéšæ„çš„æ–°æ‰‹å¼€å‘è€…å‡†å¤‡çš„

çœ‹è¿™ä¸ªä¾‹å­

```HTML
<!-- åŸæœ¬çš„dom -->
<ul id="ul">
  <li>a</li>
  <li>a</li>
  <li>a</li>
</ul>
```
```JavaScript
// æ‹¿åˆ°ç»“æœä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€æŠŠæ—§domå…¨æ›¿æ¢äº†
$.get('/api', (res) => {
  var _HTML = ""
  for(var i=0; i< res.length; i++){
    _HTML = "<li>" + res[i] +"</li>"
  }
  $("#ul").html(_HTML)
})
```

å¦‚æœæ˜¯åŸå§‹çš„`Dom`æ“ä½œï¼Œ æœ‰å¾ˆå¤šå°ç™½ä¼šåƒè¿™ä¸ªä¾‹å­ä¸€æ ·ï¼Œ ä¸ç®¡`Dom`éœ€ä¸éœ€è¦æ›´æ–°ï¼Œ ä»–éƒ½æŠŠ`ajax`è¿”å›çš„è¯·æ±‚å…¨éƒ¨è·‘ä¸€è¾¹ï¼Œç”Ÿæˆ`HTML`æ¨¡æ¿ï¼Œ ç„¶åæŠŠåŸæœ¬çš„æ‰€æœ‰`li`éƒ½åˆ äº†ï¼Œ  å†æŠŠæ–°çš„æ¨¡æ¿æ”¾è¿›å»ï¼Œ `Dom`å°‘è¿˜çœ‹ä¸å‡ºæ¥ï¼Œ å¦‚æœ`Dom`å¤šäº†å‘¢ï¼Œ ä¸Šåƒçš„`Dom`ï¼Œ è¿™é¡¿æ“ä½œä¸€ä¸‹å°±ç©ç‚¸äº†ã€‚

å†µä¸”ç½‘ç«™ä¼˜åŒ–åŸåˆ™å°±æ˜¯å°½é‡å‡å°`Dom`æ“ä½œï¼Œ å¦‚æœæ˜¯æœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œ ä¼šé€‰æ‹©æ‰¾åˆ°æœ‰å˜åŒ–çš„ä½ç½®ï¼Œä½¿ç”¨`append`æ’å…¥



## ğŸ“„Vueæ¶æ„ç›®å½•
å»[Vueå®˜ç½‘](https://github.com/vuejs/vue)ä¸‹è½½Vueæºç çœ‹çœ‹ï¼Œ

æ‰“å¼€é‡Œé¢ä¼šæœ‰ä¸€ä¸ª srcç›®å½•ï¼Œ é‡Œé¢å°±æ˜¯æ•´ä¸ªçš„Vueæºç 

ç›®å‰æœ‰6ä¸ªç›®å½•ï¼Œ ä½œç”¨åˆ†åˆ«å¦‚ä¸‹

![Vueç›®å½•](http://img.nixiaolei.com/2019-03-30-10-44-35.png)


Vue.js çš„ç»„æˆæ˜¯ç”± `core` + å¯¹åº”çš„ 'å¹³å°' è¡¥å……ä»£ç æ„æˆï¼ˆç‹¬ç«‹æ„å»ºå’Œè¿è¡Œæ—¶æ„å»ºåªæ˜¯ `platforms` ä¸‹ web å¹³å°çš„ä¸¤ç§é€‰æ‹©ï¼‰

vueçš„æ ¸å¿ƒåŸç†å°±åœ¨coreæ–‡ä»¶å¤¹ä¸­ï¼Œ è®©æˆ‘ä»¬è¿›å…¥ `core` æ–‡ä»¶å¤¹çœ‹çœ‹

![coreæ–‡ä»¶å¤¹](http://img.nixiaolei.com/2019-03-30-10-57-26.png)

äº†è§£äº†ç›®å½•ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥ç ”ç©¶Vueçš„åŒå‘ç»‘å®š

## ğŸ”—åŒå‘ç»‘å®šï¼ˆå“åº”å¼åŸç†ï¼‰ æ‰€æ¶‰åŠåˆ°çš„æŠ€æœ¯
* âœ… **Obejct.defineProperty** _ã€æä¾›getter å’Œ setterã€‘_
* âœ… **Observer** _ã€æä¾›getter å’Œ setterã€‘_
* âœ… **watcher**  _ã€æä¾›getter å’Œ setterã€‘_
* âœ… **Dep** _ã€è´Ÿè´£æ”¶é›†watcherã€‘_
* âœ… **Directive** _ã€å¤„ç†Vueæ¨¡æ¿æŒ‡ä»¤ã€‘_


### Obejct.defineProperty


`Obejct.defineProperty` æ˜¯æ•´ä¸ª`Vue`çš„çµé­‚ï¼Œ 

æ¥çœ‹ä¸€ä¸‹`Obejct.defineProperty` å¦‚ä½•ä½¿ç”¨
```JavaScript
var obj = {}
var c;
Object.defineProperty(obj, 'a', {
  get() {
    console.log('getter')
    return a
  },
  set(newVal) {
    console.log('setter')
    c = newVal
    this.a = newVal
  }
})

obj.a = '234'
console.log(c) // 234
console.log(obj.a) // 234
```


å®ƒå¸®åŠ©`Vue`å®ç°äº†åŒå‘ç»‘å®š, ä½†ä¹Ÿå› ä¸ºè¿™ä¸ªï¼Œ `Vue`ä¹Ÿåªèƒ½èˆå¼ƒäº†å¯¹ä½ç‰ˆæœ¬æµè§ˆå™¨çš„æ”¯æŒã€‚


![definePropertyå…¼å®¹](http://img.nixiaolei.com/2019-03-30-11-48-41.png)

å®ƒåªèƒ½å…¼å®¹åˆ°`IE9` ï¼Œ å¹¶ä¸”å¸‚é¢ä¸Šçš„`polyfill`å®ç°çš„ä¹Ÿå¹¶ä¸æ˜¯å¾ˆå¥½

é‚£ä½ç‰ˆæœ¬å¦‚ä½•ä»£æ›¿`Obejct.defineProperty` ï¼Ÿï¼Œ éš¾é“çœŸæ²¡äº†å®ƒå°±ä¸è¡Œå—ï¼Ÿ


**å½“ç„¶æœ‰**ï¼š

1. ğŸ‘† > IE 7

å®é™…ä¸Šåœ¨IE7çš„æ—¶å€™å°±å·²ç»æœ‰æš´éœ²äº† `__defineGetter__` æ–¹æ³•ï¼Œ
![__defineGetter__](http://img.nixiaolei.com/2019-03-30-12-57-56.png)

å…·ä½“ç”¨æ³•å¦‚ä¸‹
```JavaScript
var random = {};
random.__defineGetter__('ten', function() { 
    return Math.floor(Math.random()*10); });
random.__defineGetter__('hundred', function() { 
    return Math.floor(Math.random()*100); });

random.ten // 4
```

2.  ğŸ‘‡ < IE 7

æ—©å¹´é—´çš„`IE` æ˜¯æ”¯æŒ`VBScript`,  [VBScript](http://www.w3school.com.cn/vbscript/index.asp) å°±å¯ä»¥ç›´æ¥å†™ç±»ï¼Œ å¹¶ä¸”ä¹Ÿæ”¯æŒ`get`ï¼Œ`set`æ–¹æ³•

```JavaScript
class Test {
  get name () {
    
  }
  set name() {

  }
}
```

### ğŸ¶éœ¸é“çš„IE
è¯´äº†è¿™ä¹ˆå¤š`IE`çš„åï¼Œ è¿™é‡Œä¹Ÿå¸¦ä¸€å˜´IEçš„å¥½ï¼Œ

`IE`èƒ½å¤Ÿè°ƒç”¨`EXE`ç¨‹åº, æ¯”å¦‚`JS`æ— æ³•è®¾ç½®æ‰“å°æœºçš„å®½é«˜ï¼Œå°±å¯ä»¥åˆ©ç”¨`ActiveObjectX`æ¥åšåˆ°, ç”šè‡³å¯ä»¥ä¿®æ”¹`word`æ ¼å¼ç­‰ç­‰  , æ‰€ä»¥åŠå…¬ç±»çš„é¡¹ç›®ç¦»ä¸å¼€`IE`





## ğŸ˜•MVVM åŒå‘æ•°æ®ç»‘å®šæµç¨‹


MVVM: Modelâ€“viewâ€“viewmodel

é‚£æ€ä¹ˆåŒºåˆ†è¿™äº›å±‚å‘¢

* ğŸš€**Model**: Observer
* âœˆï¸**view** : directive
* ğŸšš**viewmodel**: Watcher && Dep  _ã€ç”¨äºè¿æ¥ Model å’Œ viewã€‘_


![åŒå‘æ•°æ®ç»‘å®š](http://img.nixiaolei.com/2019-03-30-11-51-42.png)



å…ˆçœ‹`Directive`, è¿™å°±æ˜¯æˆ‘ä»¬å¹³æ—¶å†™çš„`vue`æŒ‡ä»¤ï¼Œ å¦‚ä¸Šé¢ä¸¾ä¾‹å¾—çš„`v-text="times"`, è¿™å°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œ ä¸€ä¸ª`Directive`ä¼šåˆ†é…ä¸€ä¸ª`Watcher`



### Observer

è§‚å¯Ÿè€…æ¨¡å¼æ˜¯è½¯ä»¶è®¾è®¡æ¨¡å¼çš„ä¸€ç§ã€‚åœ¨æ­¤ç§æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç›®æ ‡å¯¹è±¡ç®¡ç†æ‰€æœ‰ç›¸ä¾äºå®ƒçš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å®ƒæœ¬èº«çš„çŠ¶æ€æ”¹å˜æ—¶ä¸»åŠ¨å‘å‡ºé€šçŸ¥ã€‚è¿™é€šå¸¸é€è¿‡å‘¼å«å„è§‚å¯Ÿè€…æ‰€æä¾›çš„æ–¹æ³•æ¥å®ç°ã€‚æ­¤ç§æ¨¡å¼é€šå¸¸è¢«ç”¨æ¥å®æ—¶äº‹ä»¶å¤„ç†ç³»ç»Ÿã€‚è®¢é˜…è€…æ¨¡å¼æ¶‰åŠä¸‰ä¸ªå¯¹è±¡ï¼šå‘å¸ƒè€…ã€ä¸»é¢˜å¯¹è±¡ã€è®¢é˜…è€…ï¼Œä¸‰ä¸ªå¯¹è±¡é—´çš„æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œæ¯å½“ä¸»é¢˜å¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå…¶ç›¸å…³ä¾èµ–å¯¹è±¡éƒ½ä¼šå¾—åˆ°é€šçŸ¥ï¼Œå¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚

ç®€å•çš„æè¿°å°±æ˜¯:

ä½ æƒ³ä¹°æ¼«ç”»ï¼Œ ä½†æ˜¯é—®äº†æŠ¥åˆŠäº­çš„å¤§çˆ·ï¼Œ å¤§çˆ·è¯´ç°åœ¨æ²¡æœ‰ï¼Œ è¿˜æ²¡åˆ°è´§ï¼Œ ç„¶åä½ å›å»äº†ï¼Œ ç¬¬äºŒå¤©ä½ åˆå»é—®ï¼Œ å¤§çˆ·è¿˜æ˜¯è¯´æ²¡æœ‰ï¼Œ å¦‚æœä½ æ¯å¤©è¿™æ ·é—®ï¼Œ å¤§çˆ·ä¼°è®¡ä¼šå«Œä½ çƒ¦ã€‚ å¦‚æœè¿™æ—¶å€™ä½ æŠŠä½ çš„ç”µè¯ç»™å¤§çˆ·ï¼Œ å¤§çˆ·è®°å½•åˆ°ä»–çš„**æœ¬å­**ä¸Š,  å½“å¤§çˆ·çš„æ¼«ç”»åˆ°è´§çš„æ—¶å€™ç”µè¯é€šçŸ¥ä½ ã€‚

è¿™æ—¶ä½ å°±æ˜¯`è®¢é˜…è€…`, å¤§çˆ·å°±æ˜¯`å‘å¸ƒè€…`, ä½ ä»¬å°±å­˜åœ¨ä¸€ä¸ªå‘å¸ƒè®¢é˜…è€…çš„å…³ç³»


## Vue3é‡å†™çš„åŸå› 
// `Obejct.defineProperty`



ä¼˜è´¨æ–‡çŒ®: 
* [æ±¤å§†å¤§å”çš„è§‚å¯Ÿè€…æ¨¡å¼](http://www.cnblogs.com/TomXu/archive/2012/03/02/2355128.html)