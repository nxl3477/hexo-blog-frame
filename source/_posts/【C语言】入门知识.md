---
title: 【C语言】入门知识
date: 2019-03-23 22:07:29
categories: C语言
tags: C语言
---

![C语言](http://img.nixiaolei.com/2019-04-04-22-39-41.png)
C语言的诞生要比JavaScript早很多, 属于低级语言，比较擅长和系统交互写底层应用。

C语言的编译工具就是gcc


## 🤯前端不限端
作为一名优质的前端切图仔， 不应该把自己困死在前端中， 更应该多开阔视野， 朝较底层的方向探索

当然， 这只是鸡汤， 我们来看看前端学习C语言的必要性

* 编译开源软件的源代码
* C语言基本语法，要看得懂代码
* 指针和C语言的坑
* 从内存层面理解数据结构
* 搞懂V8的内存管理机制
* 分析webkit引擎代码
* 用C语言编写Node.js和PHP扩展模块



## C语言沉浮录
C语言的前身是B语言


* 天生的系统级语言
* 最早用来编写Unix内核
* 曾经最流行的语言
* 至今仍在不断发展

![语言发展史](http://img.nixiaolei.com/2019-04-06-13-46-58.png)


## C语言和JavaScript的异同

* C语言是编译型语言
* C语言要借助编译器转换成可执行程序
* JavaScript是解释型语言
* JavaScript要借助解释引擎运行

![语言编译过程](http://img.nixiaolei.com/2019-04-06-13-58-53.png)

需要编译的语言经过编译后生成目标程序， 其实生成目标程序时已经是机器指令了， 但是计算机仍旧无法直接运行它，因为操作系统有他自己的规则， 想要符合操作系统的规则， 这时候就要走链接， 那链接做了哪些事让操作系统能够识别到该程序呢：

1. 给操作系统一个识别块，操作系统先读识别块再运行程序
2. 把生成的很多`.obj`文件串起来， 连成一块





## C语言与C++语言的区别
1. C++是新的编程语言，并不是C的扩展
2. C语言是面向过程的，C＋＋是面向对象的
3. C和C++语言都有标准库【standard.io】
4. 目前C大多用在网络相关和嵌入式等方面【不管Python、还是JS，底层都需要C语言基本环境】
5. 目前C++大多用在复杂引擎和应用软件方面




## 理解内存与指针
* 内存与内存地址
* 指针、地址与引用
* 指向变量的指针
* 指向指针的指针
* 指向函数的指针
* 动态内存分配


要理解内存和指针首先我们应该知道内存在计算机中是什么样子的， 我们可以把内存看作是一个打了很多格子的小纸条，**每个格子就是内存的基本存储单位**, 1个单位是一个字节，也就是一个`byte`, 而一个`byte`等于8个`bit`，那我们该如何找到对应的内存呢， 实际上内存是有编号的，这个编号从0开始， 作为内存的地址（门牌）

![内存地址](http://img.nixiaolei.com/2019-04-06-14-38-20.png)

### 指针
> 指针其实也是可以运算的，但大多数情况没有意义，  一般用在计算存储空间

容纳内存地址的变量就是指针

C语言中， 指针也是有类型的， 因为不同的数据类型对应内存中的所占的大小不一样， 定义类型是为了从内存中拿出正确长度的数据， 比如： 短整型只占两个字节、 长整型占4个字节、  超长整型占8个字节、单精度浮点型占6个字节、 双精度浮点型占8个字节

如果不正确定义指针的类型，就会导致从内存中拿出来的长度是错的， 也就是导致得到的值是错的


![理解指针](http://img.nixiaolei.com/2019-04-06-15-09-10.png)

#### 🕵️‍一级指针结构
![一级指针结构](http://img.nixiaolei.com/2019-04-06-15-13-36.png)





#### 🕵️‍二级指针结构
![二级指针结构](http://img.nixiaolei.com/2019-04-06-15-14-35.png)


#### 🤒声明指针
> 一开始声明的指针我们只能给他一个Null或是 内存地址, 因为一个具体的值对于指针是没有意义的，

声明一个整型的指针
```C
// 声明一个变量， 会自动分配内存
int a = 10;

// 声明一个指向变量a的指针
int * p_a = &a;
```
#### 🧐直接寻址和间接寻址
直接使用变量和利用指针访问的结构是一样的
```C
printf(a);  // 10
printf( *p );  // 10
```


#### 🤒二级指针及多级指针
> 不管是几级指针编译器都是能够通过的


```C
// 声明一个变量， 会自动分配内存
int a = 10;

// 声明一个指向变量a的指针
int * p_a = &a;

// 声明一个指向指针的指针
int ** pp_a = &p_a;
```


#### 指向函数的指针
> 函数它本身也在内存当中, 当我们看到一个指向函数的指针时就代表着函数调用， 回调函数就是基于指针的

C语言的函数是有原型的

声明一个两数相加函数的原型
```C
// 函数返回类型及参数类型
int add( int, int );
```

实现函数
```C
int add(int v1, int v2) 
{
  return v1 + v2;
}
```

创建指向函数的指针
```C
int*(int, int) p_func;
p_func = add;
```





### 引用

引用是对指针的封装， 现代语言不允许你直接去操作地址  因为现代语言都自带着垃圾回收机制， 在垃圾回收的过程中， 地址会经常改变，  改变地址的目的是为了提高内存的利用效率， 使内存连续




## 内存动态分配

C语言主要分如下四个区


内存    | 描述  | 特性 
:--------------:|:-----:|:-----:
栈区    | 是一个确定的常数(1~2M) 不同平台会有不同大小，超出会提示stackoverflow |  自动分配, 自动释放
堆区   | 用于动态内存分配 | 手动分配和释放 ， 可占用80%内存
全局区或静态区  | 在程序中明确被初始化的全局变量、静态变量（包括全局静态变量和局部静态变量）和常量数据（如字符串常量） | 只初始化一次 
程序代码区  | 代码区指令根据程序设计流程依次执行，对于顺序指令，则只会执行一次（每个进程），如果反复，则需要使用跳转指令，如果进行递归，则需要借助栈来实现。 | 代码区的指令中包括操作码和要操作的对象（或对象地址引用）




* 栈区： 还用来保存当前函数的局部变量
* 堆区： 存放new出来的变量
* 全局区或静态区: 存放全局变量及对象的静态变量
* 程序代码区:  存放指令、代码， 以前的金山游侠修改器就是专门改程序代码区的




### 分配内存代码
```C
int * p;

// size_t 表示一个无符号整型
// p = malloc( size_t );

// 给整型分配空间必须 传入整型长度的倍数（ 整型长度是 4个字节）
// 这样我就申请了40个字节的内存空间， 它能容纳10个整型的数字
p = malloc(40);

// 实际上 malloc 申请到的是一个数组， 下面这样是对前4个字节进行赋值
*p = 1;
// 实际等价于
p[0] = 1;

// 如果你要给其他位置的字节赋值, 这样表示向后移动一个元素单位的位置
*(p+1) = 2; 
// 等价于
p[1] = 2;
```

### 释放内存
```C
free(p)
```











